import{_ as h}from"./Page.vue_vue_type_style_index_0_lang-CBK_6bQI.js";import{n as F,r,T as G,S as g,J as $,j as v,q as f,w as s,h as l,W as p,X as V,z as t,K as M,t as b,s as S,U as j}from"./index-D0IgMKEj.js";import{u as q,V as P,a as z}from"./VRadioGroup-COKyGsjp.js";import{u as J,a as _}from"./dto-0tFHnkcw.js";import{a as k,V as K}from"./VDataTable-C6KaC_c3.js";import{V as y}from"./VTextField-CzG6H3Wj.js";const W={class:"flex gap-4 p-5"},X={class:"flex gap-3"},E={class:"d-flex gap-1 justify-center"},oe=F({__name:"invoices",setup(H){const m=r(null),C=G(),u=J(),c=q(),{studentsNamesList:N,familiesNamesList:A}=g(c),n=r(new _),{invoicesList:i}=g(u),x=()=>{j().SetPageMeta({breadCrumb:[],icon:"ri-cash-line",title:"Invoices"}),u.GetInvoices().then(()=>{i.value=i.value.map(o=>({...o,schoolPrice:o.schoolPrice.toLocaleString(),busPrice:o.busPrice.toLocaleString(),totalAmount:o.totalAmount.toLocaleString(),remainingAmount:o.remainingAmount.toLocaleString()}))})},B=()=>{var o;c.GetStudentsNames(),c.GetFamiliesNames(),(o=m.value)==null||o.openDialog()};x();const L=()=>{var o;n.value=new _,(o=m.value)==null||o.closeDialog()},w=()=>{u.AddInvoice(n.value)},D=[{title:"Name",value:"name"},{title:"School Price",value:"schoolPrice"},{title:"Bus Price",value:"busPrice"},{title:"Total",value:"totalAmount"},{title:"Remaining",value:"remainingAmount"},{title:"Details",value:"actions",align:"center"}],d=r("student"),U=r([...i.value]),R=o=>{U.value=i.value.filter(e=>e.studentId.name.includes(o))};return(o,e)=>{const I=$("IconBtn");return v(),f(h,{ref_key:"InvoicesPage",ref:m,icon:"tabler-user","button-text":"Add Invoice","dialog-title":"New Invoice","onUpdate:search":R},{"action-button":s(()=>[l(V,{onClick:B},{default:s(()=>e[5]||(e[5]=[p("Add Invoice")])),_:1})]),"dialog-form":s(()=>[l(z,{inline:"",modelValue:t(d),"onUpdate:modelValue":e[0]||(e[0]=a=>M(d)?d.value=a:null),class:"mb-4"},{default:s(()=>[l(P,{value:"student",label:"Student Invoice "}),l(P,{value:"family",label:"Family Invoice"})]),_:1},8,["modelValue"]),b("div",W,[t(d)==="student"?(v(),f(k,{key:0,label:"Student Name",class:"w-1/2",modelValue:t(n).studentId,"onUpdate:modelValue":e[1]||(e[1]=a=>t(n).studentId=a),items:t(N),"item-title":"name","item-value":"_id"},null,8,["modelValue","items"])):(v(),f(k,{key:1,label:"Family Name",modelValue:t(n).familyId,"onUpdate:modelValue":e[2]||(e[2]=a=>t(n).familyId=a),class:"w-1/2",items:t(A),"item-title":"familyName","item-value":"_id"},null,8,["modelValue","items"])),l(y,{label:"Bus Price",type:"number",modelValue:t(n).busPrice,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).busPrice=a),modelModifiers:{number:!0}},null,8,["modelValue"]),l(y,{label:"School Price",type:"number",modelValue:t(n).schoolPrice,"onUpdate:modelValue":e[4]||(e[4]=a=>t(n).schoolPrice=a),modelModifiers:{number:!0}},null,8,["modelValue"])]),b("div",X,[l(V,{onClick:w},{default:s(()=>e[6]||(e[6]=[p("Save")])),_:1}),l(V,{onClick:L,variant:"outlined"},{default:s(()=>e[7]||(e[7]=[p("Cancel")])),_:1})])]),default:s(()=>[l(K,{headers:D,items:t(i)},{"item.actions":s(({item:a})=>[b("div",E,[l(I,{onClick:T=>t(C).push(`invoices/${a._id}`)},{default:s(()=>[l(S,{icon:"ri-home-smile-line"})]),_:2},1032,["onClick"]),l(I,{onClick:T=>t(u).DeleteInvoice(a._id)},{default:s(()=>[l(S,{color:"error",icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])])]),_:1},8,["headers","items"])]),_:1},512)}}});export{oe as default};
