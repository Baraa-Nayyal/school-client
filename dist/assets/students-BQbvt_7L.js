var X=Object.defineProperty;var H=(m,u,i)=>u in m?X(m,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):m[u]=i;var n=(m,u,i)=>H(m,typeof u!="symbol"?u+"":u,i);import{_ as O}from"./Page.vue_vue_type_style_index_0_lang-CBK_6bQI.js";import{n as Q,r as v,S as D,d as Y,J as Z,j as _,q as h,w as o,h as a,W as b,X as C,t as p,z as t,K as ee,k as U,$ as x,v as F,s as N,U as le}from"./index-D0IgMKEj.js";import{u as te}from"./DivisionsStore-BdP1BLfU.js";import{u as ae,V as w,a as se}from"./VRadioGroup-COKyGsjp.js";import{V}from"./VTextField-CzG6H3Wj.js";import{a as S,V as I}from"./VDataTable-C6KaC_c3.js";class B{constructor(){n(this,"name");n(this,"class");n(this,"dadName");n(this,"momName");n(this,"area");n(this,"dadNumber");n(this,"momNumber");n(this,"division");n(this,"driver")}}class L{constructor(){n(this,"familyName");n(this,"studentIds")}}const de={class:"w-full"},oe={key:0,class:"grid grid-cols-2 gap-4 p-5 md:grid-cols-3"},ie={key:1,class:"p-5 flex gap-4"},ne={class:"flex gap-2 flex-row-reverse"},ue={class:"flex flex-col gap-3"},me={class:"d-flex gap-1 justify-center"},re={class:"d-flex gap-1 justify-center"},ye=Q({__name:"students",setup(m){const u=v(null),i=ae(),k=te(),{studentsList:y,familiesList:G,studentsNamesList:$}=D(i),{classesList:A}=D(k);(()=>{le().SetPageMeta({breadCrumb:[],icon:"ri-user-smile-line",title:"Students"}),i.GetAllStudents(),i.GetAllFamilies()})();const j=()=>{var d;(d=u.value)==null||d.closeDialog(),s.value=new B,f.value=new L},s=v(new B),f=v(new L),q=()=>{i.AddStudent(s.value).then(()=>{})},R=()=>{i.AddFamily(f.value)},T=Y(()=>{var d;return((d=A.value.find(l=>l._id===s.value.class))==null?void 0:d.divisionsIds)||[]}),M=[{title:"Student Name",value:"name"},{title:"Class",value:"class.name"},{title:"Details",value:"actions",align:"center"}],P=[{title:"Family Name",value:"familyName"},{title:"Students",value:"students"},{title:"Details",value:"actions",align:"center"}],z=()=>{var d;i.GetStudentsNames(),k.GetAllClasses(),(d=u.value)==null||d.openDialog()},r=v("student"),E=d=>{i.DeleteStudent(d)},J=d=>{i.DeleteFamily(d)},K=v([...y.value]),W=d=>{K.value=y.value.filter(l=>l.name.includes(d))};return(d,l)=>{const c=Z("IconBtn");return _(),h(O,{ref_key:"StudentsPage",ref:u,icon:"tabler-user","button-text":"Add","dialog-title":"Add New","onUpdate:search":W},{"action-button":o(()=>[a(C,{onClick:z},{default:o(()=>l[13]||(l[13]=[b("Add")])),_:1})]),"dialog-form":o(()=>[p("div",de,[a(se,{modelValue:t(r),"onUpdate:modelValue":l[0]||(l[0]=e=>ee(r)?r.value=e:null)},{default:o(()=>[a(w,{value:"student",label:"Student"}),a(w,{value:"family",label:"Family"})]),_:1},8,["modelValue"]),t(r)==="student"?(_(),U("div",oe,[a(V,{modelValue:t(s).name,"onUpdate:modelValue":l[1]||(l[1]=e=>t(s).name=e),label:"* Student Name",rules:[e=>!!e||"field is required"]},null,8,["modelValue","rules"]),a(S,{modelValue:t(s).class,"onUpdate:modelValue":l[2]||(l[2]=e=>t(s).class=e),label:"*الصف",items:t(A),"item-value":"_id","item-title":"name",rules:[e=>!!e||"field is required"]},null,8,["modelValue","items","rules"]),a(S,{modelValue:t(s).division,"onUpdate:modelValue":l[3]||(l[3]=e=>t(s).division=e),items:t(T),"item-value":"_id","item-title":"name",label:"*الشعبة",rules:[e=>!!e||"field is required"]},null,8,["modelValue","items","rules"]),a(V,{modelValue:t(s).dadName,"onUpdate:modelValue":l[4]||(l[4]=e=>t(s).dadName=e),label:"Father's Name"},null,8,["modelValue"]),a(V,{modelValue:t(s).momName,"onUpdate:modelValue":l[5]||(l[5]=e=>t(s).momName=e),label:"Mom's Name"},null,8,["modelValue"]),a(V,{modelValue:t(s).area,"onUpdate:modelValue":l[6]||(l[6]=e=>t(s).area=e),label:"Area"},null,8,["modelValue"]),a(V,{modelValue:t(s).dadNumber,"onUpdate:modelValue":l[7]||(l[7]=e=>t(s).dadNumber=e),label:"Father's Number"},null,8,["modelValue"]),a(V,{modelValue:t(s).momNumber,"onUpdate:modelValue":l[8]||(l[8]=e=>t(s).momNumber=e),label:"Mom's Number"},null,8,["modelValue"]),a(S,{modelValue:t(s).driver,"onUpdate:modelValue":l[9]||(l[9]=e=>t(s).driver=e),"item-value":"_id","item-title":"name",label:"Driver"},null,8,["modelValue"])])):x("",!0),t(r)==="family"?(_(),U("div",ie,[a(V,{label:"Family Name",modelValue:t(f).familyName,"onUpdate:modelValue":l[10]||(l[10]=e=>t(f).familyName=e)},null,8,["modelValue"]),a(S,{label:"Students",modelValue:t(f).studentIds,"onUpdate:modelValue":l[11]||(l[11]=e=>t(f).studentIds=e),items:t($),"item-value":"_id","item-title":"name",multiple:""},null,8,["modelValue","items"])])):x("",!0),p("div",ne,[a(C,{onClick:l[12]||(l[12]=e=>t(r)==="student"?q():R())},{default:o(()=>[b(F(t(r)==="student"?"Add Student":"Add Family"),1)]),_:1}),a(C,{onClick:j,variant:"outlined"},{default:o(()=>l[14]||(l[14]=[b("Cancel")])),_:1})])])]),default:o(()=>[p("div",ue,[a(I,{headers:M,items:t(y)},{"item.actions":o(({item:e})=>[p("div",me,[a(c,{onClick:g=>E(e._id)},{default:o(()=>[a(N,{color:"error",icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"]),a(c,null,{default:o(()=>[a(N,{icon:"ri-edit-line"})]),_:1})])]),_:1},8,["headers","items"]),a(I,{headers:P,items:t(G)},{"item.actions":o(({item:e})=>[p("div",re,[a(c,{onClick:g=>J(e._id)},{default:o(()=>[a(N,{color:"error",icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"]),a(c,null,{default:o(()=>[a(N,{icon:"ri-edit-line "})]),_:1})])]),"item.students":o(({item:e})=>[b(F(e.students.map(g=>g.name).join(", ")),1)]),_:1},8,["headers","items"])])]),_:1},512)}}});export{ye as default};
